( 
    () => {
        // Input field
        var searchField = document.querySelector('.search-wrapper .form-control');
        // If we need to change a tab, another field is required to fill names in
        window.addEventListener('vd.changeSearch', function(evt) {
            searchField = document.querySelector('.search-wrapper .form-control');
            changeValues(n[nameCounter]);
        })

        // Controls
        const prev = document.getElementById('hp-prev');
        const next = document.getElementById('hp-next');
        const hpSect = document.getElementById('hp-section');
        const hpNum = document.getElementById('hp-num');
        const hpFix = document.getElementById('hp-fix');

        // Build an array of names
        const n = JSON.parse(searchField.getAttribute('names'));
        const s = JSON.parse(searchField.getAttribute('sections'));
        const total = ( () => {
            var t = 0;
            s.forEach( e => {
                t += e.sectionLength;
            });
            return t;
        })();

        // Set change event to reuse later
        const eventChange = new Event('change');

        setFirstValue();

        /**
         * Set Navigation button listeners
         * Prev/Next
         */

        // Counter used by next/prev
        var nameCounter = 0;

        function changeValues(curr) {
            // Fill in the search field
            searchField.value = curr.name;
            // Trigger change event
            searchField.dispatchEvent(eventChange);

            // Set fix version
            hpFix.innerText = curr.fix;

            // Current vulnerability number in the list
            const currNum = nameCounter+1;

            // Set new section name if the first section is over
            if (currNum > s[0].sectionLength) {
                hpSect.innerText = s[1].section;
            } else {
                hpSect.innerText = s[0].section;
            }

            // Set current number
            hpNum.innerText = currNum;
        }

        prev.addEventListener('click', function () {
            (nameCounter > 0) && changeValues(n[--nameCounter])
        });

        next.addEventListener('click', function () {
            (nameCounter >= 0 && (nameCounter+1) < total ) && changeValues(n[++nameCounter])
        });

        // Show Panel
        document.querySelector('.hp-wrap').style.display = "flex";

        function setFirstValue() {
            // Set first value
            searchField.value = n[0].name;
            hpFix.innerText = n[0].fix;
            hpSect.innerText = s[0].section;
            // Trigger change event
            searchField.dispatchEvent(eventChange);
        }
    }
)()